/*
 * Comm.c
 *
 *  Created on: Sep 16, 2016
 *      Author: mkamstra
 */
#include <msp430.h>
#include <stdint.h>
#include <stdbool.h>
#include "Comm.h"

bool debounce0 = 0;
bool debounce1 = 0;


uint8_t sci_1_pUp[39] = { 0x50, 0x50, 0x50, 0x0B,   // Science board 1 ON
						  0x01, 0xFF, 0x02, 0x00,
						  0x03, 0x00, 0x04, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00 };

uint8_t sci_2_pUp[39] = { 0x50, 0x50, 0x50, 0x0B,   // Science board 2 ON
						  0x01, 0x00, 0x02, 0xFF,
						  0x03, 0x00, 0x04, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00 };

uint8_t sci_3_pUp[39] = { 0x50, 0x50, 0x50, 0x0B,   // Science board 3 ON
						  0x01, 0x00, 0x02, 0x00,
						  0x03, 0xFF, 0x04, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00 };

uint8_t sci_4_pUp[39] = { 0x50, 0x50, 0x50, 0x0B,   // Science board 4 ON
						  0x01, 0x00, 0x02, 0x00,
						  0x03, 0x00, 0x04, 0xFF,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00 };

uint8_t sci_x_pDown[39] = { 0x50, 0x50, 0x50, 0x0B,   // Science board X OFF
						  0x01, 0x00, 0x02, 0x00,
						  0x03, 0x00, 0x04, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00, 0x00,
						  0x00, 0x00, 0x00 };



void powerUp(uint8_t sci_x_board){		
	uint8_t j = 0;
	while (j < 39)
			{
				if (sci_x_board == 1){write_UART (sci_1_pUp[j]);}		// Request power up from NSL
				if (sci_x_board == 2){write_UART (sci_2_pUp[j]);}		// Request power up from NSL
				if (sci_x_board == 3){write_UART (sci_3_pUp[j]);}		// Request power up from NSL
				if (sci_x_board == 4){write_UART (sci_4_pUp[j]);}		// Request power up from NSL
				j++;
			}
			j = 0;
}

void powerDown(uint8_t sci_x_board){
	uint8_t j = 0;
	while (j < 39)
			{
				write_UART (sci_x_pDown[j]);		// Request power up from NSL
				j++;
			}
			j = 0;
}

int Sci_Ready(void){
	if (P4IN & BIT1){debounce0 = 1;}
	__delay_cycles(50);
	if (P4IN & BIT1){debounce1 = 1;}
	if (debounce0 && debounce1){
		debounce0 = 0;
		debounce1 = 0;
		return 1;
	}
	else return 0;
	}

